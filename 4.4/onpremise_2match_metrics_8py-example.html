<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection Python: onpremise/match_metrics.py</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection Python
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">Device Detection services for 51Degrees Pipeline</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('onpremise_2match_metrics_8py-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">onpremise/match_metrics.py</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>The example illustrates the various metrics that can be obtained about the device detection process, for example, the degree of certainty about the result. Running the example outputs those properties and values.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="c-code__comment"># *********************************************************************</span></div><div class="c-code__line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="c-code__comment"># This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="c-code__comment"># Copyright 2023 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="c-code__comment"># Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="c-code__comment">#</span></div><div class="c-code__line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="c-code__comment"># This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="c-code__comment"># (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="c-code__comment">#</span></div><div class="c-code__line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="c-code__comment"># If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="c-code__comment"># one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="c-code__comment">#</span></div><div class="c-code__line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="c-code__comment"># The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="c-code__comment"># amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="c-code__comment"># the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="c-code__comment"># clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="c-code__comment">#</span></div><div class="c-code__line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="c-code__comment"># If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="c-code__comment"># including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="c-code__comment"># in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="c-code__comment"># such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="c-code__comment"># ********************************************************************* </span></div><div class="c-code__line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="c-code__line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="c-code__line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="c-code__line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="c-code__line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="c-code__comment"># The example also illustrates controlling properties that are returned from the detection</span></div><div class="c-code__line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="c-code__comment"># process - reducing the number of components required to return the properties requested reduces</span></div><div class="c-code__line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="c-code__comment"># the overall time taken.</span></div><div class="c-code__line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="c-code__comment"># </span></div><div class="c-code__line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="c-code__comment"># There is a [discussion](https://51degrees.com/documentation/_device_detection__hash.html#DeviceDetection_Hash_DataSetProduction_Performance)</span></div><div class="c-code__line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="c-code__comment"># of metrics and controlling performance on our web site. See also the (performance options)</span></div><div class="c-code__line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="c-code__comment"># [https://51degrees.com/documentation/_device_detection__features__performance_options.html]</span></div><div class="c-code__line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="c-code__comment"># page.</span></div><div class="c-code__line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="c-code__comment"># # Location</span></div><div class="c-code__line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="c-code__comment"># This example is available in full on [GitHub](https://github.com/51Degrees/device-detection-python/blob/main/fiftyone_devicedetection_examples/fiftyone_devicedetection_examples/onpremise/match_metrics.py].</span></div><div class="c-code__line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="c-code__line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="c-code__keyword">from</span> itertools <span class="c-code__keyword">import</span> groupby</div><div class="c-code__line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="c-code__keyword">from</span> pathlib <span class="c-code__keyword">import</span> Path</div><div class="c-code__line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="c-code__keyword">import</span> sys</div><div class="c-code__line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="c-code__keyword">from</span> <a class="code" href="namespacefiftyone__devicedetection_1_1devicedetection__pipelinebuilder.html">fiftyone_devicedetection.devicedetection_pipelinebuilder</a> <span class="c-code__keyword">import</span> DeviceDetectionPipelineBuilder</div><div class="c-code__line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="c-code__keyword">from</span> fiftyone_pipeline_core.logger <span class="c-code__keyword">import</span> Logger</div><div class="c-code__line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="c-code__keyword">from</span> fiftyone_pipeline_core.basiclist_evidence_keyfilter <span class="c-code__keyword">import</span> BasicListEvidenceKeyFilter</div><div class="c-code__line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="c-code__comment"># pylint: disable=E0402</span></div><div class="c-code__line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="c-code__keyword">from</span> ..example_utils <span class="c-code__keyword">import</span> ExampleUtils</div><div class="c-code__line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="c-code__keyword">from</span> <a class="code" href="namespacefiftyone__devicedetection__shared_1_1example__constants.html">fiftyone_devicedetection_shared.example_constants</a> <span class="c-code__keyword">import</span> EVIDENCE_VALUES</div><div class="c-code__line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="c-code__keyword">from</span> <a class="code" href="namespacefiftyone__devicedetection__shared_1_1example__constants.html">fiftyone_devicedetection_shared.example_constants</a> <span class="c-code__keyword">import</span> LITE_DATAFILE_NAME</div><div class="c-code__line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="c-code__line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="c-code__keyword">class </span>MatchMetricsConsole():</div><div class="c-code__line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div><div class="c-code__line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="c-code__keyword">def </span><a class="code" href="namespacefiftyone__devicedetection__examples_1_1onpremise_1_1performance.html#a78b63f027c93544e4a7174f8b56d0a03">run</a>(self, data_file, show_descs, logger, output):</div><div class="c-code__line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="c-code__comment"># Build a new Pipeline to use an on-premise Hash engine with the</span></div><div class="c-code__line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="c-code__comment"># low memory performance profile.</span></div><div class="c-code__line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        pipeline = DeviceDetectionPipelineBuilder(</div><div class="c-code__line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            data_file_path = data_file,</div><div class="c-code__line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="c-code__comment"># Inhibit auto-update of the data file for this example</span></div><div class="c-code__line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            auto_update = <span class="c-code__keyword">False</span>,</div><div class="c-code__line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            licence_keys = <span class="c-code__stringliteral">&quot;&quot;</span>,</div><div class="c-code__line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="c-code__comment"># Prefer low memory profile where all data streamed from disk</span></div><div class="c-code__line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="c-code__comment"># on-demand. Experiment with other profiles.</span></div><div class="c-code__line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            performance_profile = <span class="c-code__stringliteral">&quot;LowMemory&quot;</span>,</div><div class="c-code__line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="c-code__comment">#performance_profile = &quot;HighPerformance&quot;,</span></div><div class="c-code__line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="c-code__comment">#performance_profile = &quot;Balanced&quot;,</span></div><div class="c-code__line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="c-code__comment"># Disable share usage for this example.</span></div><div class="c-code__line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            usage_sharing = <span class="c-code__keyword">False</span>,</div><div class="c-code__line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="c-code__comment"># You can improve matching performance by specifying only those</span></div><div class="c-code__line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="c-code__comment"># properties you wish to use. If you don&#39;t specify any properties</span></div><div class="c-code__line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="c-code__comment"># you will get all those available in the data file tier that</span></div><div class="c-code__line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="c-code__comment"># you have used. The free &quot;Lite&quot; tier contains fewer than 20.</span></div><div class="c-code__line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="c-code__comment"># Since we are specifying properties here, we will only see</span></div><div class="c-code__line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="c-code__comment"># those properties, along with the match metric properties</span></div><div class="c-code__line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="c-code__comment"># in the output.</span></div><div class="c-code__line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            restricted_properties=[<span class="c-code__stringliteral">&quot;ismobile&quot;</span>, <span class="c-code__stringliteral">&quot;hardwarename&quot;</span>],</div><div class="c-code__line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="c-code__comment"># Uncomment BrowserName to include Browser component profile ID</span></div><div class="c-code__line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="c-code__comment"># in the device ID value.</span></div><div class="c-code__line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="c-code__comment">#restricted_properties=[&quot;ismobile&quot;, &quot;hardwarename&quot;, &quot;browsername&quot;],</span></div><div class="c-code__line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="c-code__comment"># If using the full on-premise data file this property will be</span></div><div class="c-code__line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="c-code__comment"># present in the data file. See https://51degrees.com/pricing</span></div><div class="c-code__line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="c-code__comment"># Only use the predictive graph to better handle variances</span></div><div class="c-code__line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="c-code__comment"># between the training data and the target User-Agent string.</span></div><div class="c-code__line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="c-code__comment"># For a more detailed description of the differences between</span></div><div class="c-code__line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="c-code__comment"># performance and predictive, see</span></div><div class="c-code__line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="c-code__comment"># https://51degrees.com/documentation/_device_detection__hash.html#DeviceDetection_Hash_DataSetProduction_Performance</span></div><div class="c-code__line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            use_predictive_graph = <span class="c-code__keyword">True</span>,</div><div class="c-code__line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            use_performance_graph = <span class="c-code__keyword">False</span>,</div><div class="c-code__line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="c-code__comment"># We want to show the matching evidence characters as part of this example, so we have to set</span></div><div class="c-code__line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="c-code__comment"># this flag to true.</span></div><div class="c-code__line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            update_matched_useragent = <span class="c-code__keyword">True</span>).add_logger(logger).<a class="code" href="namespacebuild.html">build</a>()</div><div class="c-code__line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        </div><div class="c-code__line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        ExampleUtils.check_data_file(pipeline, logger)</div><div class="c-code__line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="c-code__line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        data = pipeline.create_flowdata()</div><div class="c-code__line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="c-code__line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="c-code__comment"># Process a single evidence to retrieve the values</span></div><div class="c-code__line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="c-code__comment"># associated with the user-agent and other evidence such as sec-ch-* for the</span></div><div class="c-code__line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="c-code__comment"># selected properties.</span></div><div class="c-code__line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        data.evidence.add_from_dict(self.Evidence)</div><div class="c-code__line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        data.process()</div><div class="c-code__line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="c-code__line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        device = data.device</div><div class="c-code__line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="c-code__line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        output(<span class="c-code__stringliteral">&quot;--- Compare evidence with what was matched ---\n&quot;</span>)</div><div class="c-code__line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        output(<span class="c-code__stringliteral">&quot;Evidence&quot;</span>)</div><div class="c-code__line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="c-code__comment"># output the evidence in reverse value length order</span></div><div class="c-code__line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="c-code__keywordflow">for</span> entry <span class="c-code__keywordflow">in</span> sorted(self.Evidence.items(), key=<span class="c-code__keyword">lambda</span> item: len(item[1]), reverse=<span class="c-code__keyword">True</span>):</div><div class="c-code__line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            output(f<span class="c-code__stringliteral">&quot;    {entry[0]}: {entry[1]}&quot;</span>)</div><div class="c-code__line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="c-code__comment"># Obtain the matched User-Agents: the matched substrings in the</span></div><div class="c-code__line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="c-code__comment"># User-Agents are separated with underscores - output in forward length order.</span></div><div class="c-code__line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        output(<span class="c-code__stringliteral">&quot;Matches&quot;</span>)</div><div class="c-code__line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="c-code__keywordflow">for</span> entry <span class="c-code__keywordflow">in</span> sorted(device.useragents.value(), key=<span class="c-code__keyword">lambda</span> item: len(item)):</div><div class="c-code__line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            output(f<span class="c-code__stringliteral">&quot;    Matched User-Agent: {entry}&quot;</span>)</div><div class="c-code__line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="c-code__line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        output(<span class="c-code__stringliteral">&quot;&quot;</span>)</div><div class="c-code__line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="c-code__line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="c-code__line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        output(<span class="c-code__stringliteral">&quot;--- Listing all available properties, by component, by property name ---&quot;</span>)</div><div class="c-code__line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        output(<span class="c-code__stringliteral">&quot;For a discussion of what the match properties mean, see: https://51degrees.com/documentation/_device_detection__hash.html#DeviceDetection_Hash_DataSetProduction_Performance\n&quot;</span>)</div><div class="c-code__line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="c-code__line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="c-code__comment"># get the properties available from the DeviceDetection engine</span></div><div class="c-code__line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="c-code__comment"># which has the key &quot;device&quot;. For the sake of illustration we will</span></div><div class="c-code__line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="c-code__comment"># retrieve it indirectly.</span></div><div class="c-code__line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        hashEngineElementKey = pipeline.get_element(<span class="c-code__stringliteral">&quot;device&quot;</span>).datakey</div><div class="c-code__line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="c-code__line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="c-code__comment"># retrieve the available properties from the hash engine. The properties</span></div><div class="c-code__line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="c-code__comment"># available depends on</span></div><div class="c-code__line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="c-code__comment"># a) the use of restricted_properties in the builder (see above)</span></div><div class="c-code__line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="c-code__comment"># which controls which properties will be extracted, and also affects</span></div><div class="c-code__line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="c-code__comment"># the performance of extraction</span></div><div class="c-code__line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="c-code__comment"># b) the tier of data file being used. The Lite data file contains fewer</span></div><div class="c-code__line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="c-code__comment"># than 20 of the &gt;200 available properties</span></div><div class="c-code__line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        availableProperties = dict(pipeline.get_properties()[hashEngineElementKey])</div><div class="c-code__line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        </div><div class="c-code__line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="c-code__comment"># create a Map keyed on the component name of the properties available</span></div><div class="c-code__line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="c-code__comment"># components being hardware, browser, OS and Crawler.</span></div><div class="c-code__line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="c-code__keyword">def </span>get_component(property):</div><div class="c-code__line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="c-code__keywordflow">return</span> property[1][<span class="c-code__stringliteral">&quot;component&quot;</span>]</div><div class="c-code__line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="c-code__line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        availableProperties = dict(sorted(availableProperties.items(),key=<span class="c-code__keyword">lambda</span> item: get_component(item)))</div><div class="c-code__line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        categoryMap = groupby(availableProperties.items(), get_component)</div><div class="c-code__line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="c-code__comment"># iterate the map created above</span></div><div class="c-code__line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="c-code__keywordflow">for</span> component, properties <span class="c-code__keywordflow">in</span> categoryMap:</div><div class="c-code__line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            output(component)</div><div class="c-code__line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="c-code__keywordflow">for</span> propertyKey, property <span class="c-code__keywordflow">in</span> properties:</div><div class="c-code__line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                propertyName = property[<span class="c-code__stringliteral">&quot;name&quot;</span>]</div><div class="c-code__line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                propertyDescription = property[<span class="c-code__stringliteral">&quot;description&quot;</span>]</div><div class="c-code__line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                </div><div class="c-code__line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="c-code__comment"># while we get the available properties and their metadata from the</span></div><div class="c-code__line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="c-code__comment"># pipeline we get the values for the last detection from flowData</span></div><div class="c-code__line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                value = device[propertyKey]</div><div class="c-code__line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                </div><div class="c-code__line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="c-code__comment"># output property names, values and descriptions</span></div><div class="c-code__line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="c-code__comment"># some property values are lists.</span></div><div class="c-code__line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="c-code__keywordflow">if</span> value.has_value() <span class="c-code__keywordflow">and</span> isinstance(value.value(), list):</div><div class="c-code__line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    output(f<span class="c-code__stringliteral">&quot;    {propertyName}: {len(value.value())} Values&quot;</span>)</div><div class="c-code__line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="c-code__keywordflow">for</span> item <span class="c-code__keywordflow">in</span> value.value():</div><div class="c-code__line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        output(f<span class="c-code__stringliteral">&quot;        : {item}&quot;</span>)</div><div class="c-code__line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="c-code__line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="c-code__keywordflow">else</span>:</div><div class="c-code__line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    output(f<span class="c-code__stringliteral">&quot;    {propertyName}: {value.value()}&quot;</span>)</div><div class="c-code__line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="c-code__line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="c-code__keywordflow">if</span> (show_descs == <span class="c-code__keyword">True</span>):</div><div class="c-code__line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    output(f<span class="c-code__stringliteral">&quot;        {propertyDescription}&quot;</span>)</div><div class="c-code__line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="c-code__line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        output()</div><div class="c-code__line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        logger.log(<span class="c-code__stringliteral">&quot;info&quot;</span>, <span class="c-code__stringliteral">&quot;Finished Match Metrics Example&quot;</span>)</div><div class="c-code__line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div><div class="c-code__line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="c-code__comment"># Evidence values from a windows 11 device using a browser</span></div><div class="c-code__line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="c-code__comment"># that supports User-Agent Client Hints.</span></div><div class="c-code__line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    Evidence = EVIDENCE_VALUES[2]</div><div class="c-code__line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="c-code__line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="c-code__keyword">def </span><a class="code" href="namespacefiftyone__devicedetection__examples_1_1cloud_1_1configurator__console.html#a31f39d9a32101ea67a5ee9b028ebd760">main</a>(argv):</div><div class="c-code__line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="c-code__comment"># In this example, by default, the 51degrees &quot;Lite&quot; file needs to be</span></div><div class="c-code__line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="c-code__comment"># somewhere in the project space, or you may specify another file as</span></div><div class="c-code__line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="c-code__comment"># a command line parameter.</span></div><div class="c-code__line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="c-code__comment">#</span></div><div class="c-code__line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="c-code__comment"># Note that the Lite data file is only used for illustration, and has</span></div><div class="c-code__line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="c-code__comment"># limited accuracy and capabilities.</span></div><div class="c-code__line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="c-code__comment"># Find out about the Enterprise data file on our pricing page:</span></div><div class="c-code__line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="c-code__comment"># https://51degrees.com/pricing</span></div><div class="c-code__line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    data_file = argv[0] <span class="c-code__keywordflow">if</span> len(argv) &gt; 0 <span class="c-code__keywordflow">else</span> ExampleUtils.find_file(LITE_DATAFILE_NAME)</div><div class="c-code__line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    </div><div class="c-code__line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="c-code__comment"># Configure a logger to output to the console.</span></div><div class="c-code__line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    logger = Logger(min_level=<span class="c-code__stringliteral">&quot;info&quot;</span>)</div><div class="c-code__line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="c-code__line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="c-code__keywordflow">if</span> (data_file != <span class="c-code__keywordtype">None</span>):</div><div class="c-code__line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        MatchMetricsConsole().<a class="code" href="namespacefiftyone__devicedetection__examples_1_1onpremise_1_1performance.html#a78b63f027c93544e4a7174f8b56d0a03">run</a>(data_file, <span class="c-code__keyword">False</span>, logger, <span class="c-code__keywordflow">print</span>)</div><div class="c-code__line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="c-code__keywordflow">else</span>:</div><div class="c-code__line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        logger.log(<span class="c-code__stringliteral">&quot;error&quot;</span>,</div><div class="c-code__line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="c-code__stringliteral">&quot;Failed to find a device detection data file. Make sure the &quot;</span> +</div><div class="c-code__line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="c-code__stringliteral">&quot;device-detection-data submodule has been updated by running &quot;</span> +</div><div class="c-code__line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="c-code__stringliteral">&quot;`git submodule update --recursive`.&quot;</span>)</div><div class="c-code__line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="c-code__line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="c-code__keywordflow">if</span> __name__ == <span class="c-code__stringliteral">&quot;__main__&quot;</span>:</div><div class="c-code__line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="namespacefiftyone__devicedetection__examples_1_1cloud_1_1configurator__console.html#a31f39d9a32101ea67a5ee9b028ebd760">main</a>(sys.argv[1:])</div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
